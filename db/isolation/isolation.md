## 트랜잭션 격리 수준

트랜잭션 격리 수준이란 동시에 여러 트랜잭션이 처리될 때 트랜잭션 끼리 얼마나 서로 고립되어 있는지를 나타내는 것을 말하며 4가지가 존재한다.

- READ UNCOMMITTED
- READ COMMITTED
- REPETABLE READ
- SERIALIZABLE



## READ UNCOMMITTED

격리수준이 READ UNCOMMITTED으로 설정된 경우 트랜잭션의 변경 내용이 COMMIT이나 ROLLBACK과 관계없이 다른 트랜잭션에서 보여진다.

즉 트랜잭션이 커밋되지 않았음에도 다른 트랜잭션에서 변경된 내용을 읽을 수 있다는 것인데 이를 Dirty Read라고 한다.



## READ COMMITTED

오라클에서는 Default 격리수준으로 사용되고있으며, 커밋이 완료된 데이터만 조회가 가능한 격리수준이다.

커밋된 데이터만 읽어오기 때문에 READ UNCOMMITTED에서 발생하던 정합성 문제가 해결된 것 처럼 보이지만 새로운 문제가 있다.

A트랜잭션에서 변경한 데이터를 아직 커밋되지 않은 상태에서 B트랜잭션에서 조회하면 변경전의 데이터가 조회되는데

바로 A트랜잭션에서 커밋을 한 후 B트랜잭션에서 동일한 조회를 수행하면 변경된 데이터가 조회된다.

이러한 결과는 하나의 트랜잭션에서 동일한 SELECT 쿼리를 수행하면 동일한 결과가 나와야한다는 규칙에 어긋난다.

이러한 현상을 Non-Repeatable Read라고 부른다.



## REPEATABLE READ

트랜잭션이 시작되기전에 커밋된 내용들에 대해서만 조회가 이루어지는 격리수준이다.

즉, READ COMMITTED 격리수준에서 발생할 가능성이 존재하는 Non-Repeatable Read 문제가 발생하지 않는 격리 수준인 것이다.

트랜잭션에 번호를 붙여 자신의 트랜잭션 번호보다 큰 번호에서 일어난 변경에 대해 조회하지 않도록 한다.

- 1번 트랜잭션이 20번 아이템 조회
- 2번 트랜잭션이 20번 아이템 이름 변경
- 1번 트랜잭션이 20번 아이템 조회

위와 같은 트랜잭션이 발생했을 때 1번 트랜잭션은 자신보다 번호가 큰 2번 트랜잭션의 결과에는 영향을 받지 않는다.

REPEATABLE READ 격리수준에서는 이전에 조회 시 발견되지 않았던 데이터가 발견되는 Phantom Read 문제가 발생할 수 있으나 InnoDB에서는 발생하지 않는다.



## SERIALIZABLE

가장 단순하고 엄격한 격리수준으로 읽고 쓰는 작업의 레코드에 대해 공유 잠금을 걸어 다른 트랜잭션에서 접근할 수 없도록 하는 격리 수준이다.

레코드에 대해 락이 걸려 동시에 다른 트랜잭션이 해당 레코드를 변경하지 못하게 되어 다른 격리수준에서 발생하는 문제를 해결할 수 있지만 성능저하가 발생하게 된다.